name: Docker CI

on:
  push:
    branches: [main]
  pull_request:

jobs:
  docker-ci:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Build CI target
        run: docker build --target ci -t s18share-ci .

      - name: Run CI target
        run: docker run --rm s18share-ci

      - name: Build runtime image
        run: docker build --target runtime -t s18share-runtime .
